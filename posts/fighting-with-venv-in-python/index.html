<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Fighting with venv in Python | Chris Paraiso</title>
<meta name="keywords" content="">
<meta name="description" content="I had a brain fart today. I was developing a personal project in Python and I had some library issues that I was trying to wrap my head around. It turns out, I didn&rsquo;t even have my virtual environment running. I completely forgot.
So then I activated it.
source .venv/bin/activate Then I thought to myself&hellip;
I don&rsquo;t want to type that out every single damn time.
I&rsquo;m lazy. I don&rsquo;t like to type unnecessary things.">
<meta name="author" content="">
<link rel="canonical" href="https://chrisparaiso.dev/posts/fighting-with-venv-in-python/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.77803e258ae4158ba8acfbb5b0f3dbe7c16b1e32cd579045e536a6495ab56dd3.css" integrity="sha256-d4A&#43;JYrkFYuorPu1sPPb58FrHjLNV5BF5TamSVq1bdM=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://chrisparaiso.dev/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://chrisparaiso.dev/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://chrisparaiso.dev/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://chrisparaiso.dev/apple-touch-icon.png">
<link rel="mask-icon" href="https://chrisparaiso.dev/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Fighting with venv in Python" />
<meta property="og:description" content="I had a brain fart today. I was developing a personal project in Python and I had some library issues that I was trying to wrap my head around. It turns out, I didn&rsquo;t even have my virtual environment running. I completely forgot.
So then I activated it.
source .venv/bin/activate Then I thought to myself&hellip;
I don&rsquo;t want to type that out every single damn time.
I&rsquo;m lazy. I don&rsquo;t like to type unnecessary things." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chrisparaiso.dev/posts/fighting-with-venv-in-python/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-23T02:36:29-07:00" />
<meta property="article:modified_time" content="2023-08-23T02:36:29-07:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Fighting with venv in Python"/>
<meta name="twitter:description" content="I had a brain fart today. I was developing a personal project in Python and I had some library issues that I was trying to wrap my head around. It turns out, I didn&rsquo;t even have my virtual environment running. I completely forgot.
So then I activated it.
source .venv/bin/activate Then I thought to myself&hellip;
I don&rsquo;t want to type that out every single damn time.
I&rsquo;m lazy. I don&rsquo;t like to type unnecessary things."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://chrisparaiso.dev/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Fighting with venv in Python",
      "item": "https://chrisparaiso.dev/posts/fighting-with-venv-in-python/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Fighting with venv in Python",
  "name": "Fighting with venv in Python",
  "description": "I had a brain fart today. I was developing a personal project in Python and I had some library issues that I was trying to wrap my head around. It turns out, I didn\u0026rsquo;t even have my virtual environment running. I completely forgot.\nSo then I activated it.\nsource .venv/bin/activate Then I thought to myself\u0026hellip;\nI don\u0026rsquo;t want to type that out every single damn time.\nI\u0026rsquo;m lazy. I don\u0026rsquo;t like to type unnecessary things.",
  "keywords": [
    
  ],
  "articleBody": "I had a brain fart today. I was developing a personal project in Python and I had some library issues that I was trying to wrap my head around. It turns out, I didn’t even have my virtual environment running. I completely forgot.\nSo then I activated it.\nsource .venv/bin/activate Then I thought to myself…\nI don’t want to type that out every single damn time.\nI’m lazy. I don’t like to type unnecessary things. I switch projects mid-day on multiple occasions at work so there’s a bit of a context switch to deal with. If I have to write automation scripts and aliases now to prevent me from typing even the smallest of words, I’ll take the time to try to solve that.\nContext issues So I did just that. I set aside some time to try to automate things.\nI wanted a command I could execute (venv). This command would run a script that creates a virtual environment via python3 -m venv .venv. Then it would run source .venv/bin/activate to start the virtual environment.\nWell, every time I ran this script, the directory would be created at the current working directory and the source line ran without error but the virtual environment did not start. The Python interpreter my environment was running was still global at /usr/local/bin/python3. So something is amiss!\nAfter doing a bit of research it turns out that when you want to enter a virtual environment, the virtual environment modifies my shell’s variables. An example of this would be modifying my shell’s variables to point to the correct Python interpreter.\nAlso, when you run a Bash script, it executes in a different context/subshell. The file and directory changes stuck after the script ran, but the necessary variables I needed for my virtual environment were thrown away as soon as the script finished running.\nSolution I removed the source line from my venv.sh script and just left the script to create the needed files and directories. I would then need to run that source command to enter the virtual environment.\nThen I thought: Why don’t I just string the commands together into one alias on my shell? Perfect.\n# aliases.sh alias venv='$HOME/src/dotfiles/bin/utils/venv.sh \u0026\u0026 \\ source .venv/bin/activate' # ... other aliases below here Running the venv alias would execute the venv.sh then run the source command in the context of the shell I am currently in.\n#!/bin/bash # venv.sh # create venv if not exists if [ -d \".venv\" ]; then echo \"Found .venv. Activating...\" else read -p \".venv does not exist. Would you like to \\ create a venv for this directory? (y/n) \" response if [ \"$response\" == \"y\" ]; then echo \"Creating .venv directory @ $PWD\" python3 -m venv .venv fi fi If venv.sh finds an existing .venv directory, it does nothing. If the script does not find the .venv directory it prompts the user asking if the script has permission to create it. I know I could probably do without the prompt and just have the script create it. I decided to leave it in for now.\nI guess my issue was with Bash and not venv. Anyway, I think I have to be careful. I’ve been getting sidetracked and spending a lot of time configuring my environment. Off to building something!\nBe sure to follow me @chrisparaiso.\n",
  "wordCount" : "555",
  "inLanguage": "en",
  "datePublished": "2023-08-23T02:36:29-07:00",
  "dateModified": "2023-08-23T02:36:29-07:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://chrisparaiso.dev/posts/fighting-with-venv-in-python/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Chris Paraiso",
    "logo": {
      "@type": "ImageObject",
      "url": "https://chrisparaiso.dev/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://chrisparaiso.dev/" accesskey="h" title="Chris Paraiso (Alt + H)">Chris Paraiso</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Fighting with venv in Python
    </h1>
    <div class="post-meta"><span title='2023-08-23 02:36:29 -0700 MST'>August 23, 2023</span>

</div>
  </header> 
  <div class="post-content"><p>I had a brain fart today. I was developing a personal project in Python and I had some library issues that I was trying to wrap my head around. It turns out, I didn&rsquo;t even have my <a href="https://docs.python.org/3/library/venv.html">virtual environment</a> running. I completely forgot.</p>
<p>So then I activated it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>source .venv/bin/activate
</span></span></code></pre></div><p>Then I thought to myself&hellip;</p>
<blockquote>
<p>I don&rsquo;t want to type that out every single damn time.</p>
</blockquote>
<p>I&rsquo;m lazy. I don&rsquo;t like to type unnecessary things. I switch projects mid-day on multiple occasions at work so there&rsquo;s a bit of a context switch to deal with. If I have to write automation scripts and aliases now to prevent me from typing even the smallest of words, I&rsquo;ll take the time to try to solve that.</p>
<h2 id="context-issues">Context issues<a hidden class="anchor" aria-hidden="true" href="#context-issues">#</a></h2>
<p>So I did just that. I set aside some time to try to automate things.</p>
<p>I wanted a command I could execute (<code>venv</code>). This command would run a script that creates a virtual environment via <code>python3 -m venv .venv</code>. Then it would run <code>source .venv/bin/activate</code> to start the virtual environment.</p>
<p>Well, every time I ran this script, the directory would be created at the current working directory and the <code>source</code> line ran without error but the virtual environment did not start. The Python interpreter my environment was running was still global at <code>/usr/local/bin/python3</code>. So something is amiss!</p>
<p>After doing a bit of research it turns out that when you want to enter a virtual environment, the virtual environment modifies my shell&rsquo;s variables. An example of this would be modifying my shell&rsquo;s variables to point to the correct Python interpreter.</p>
<p>Also, when you run a Bash script, it executes in a different context/subshell. The file and directory changes stuck after the script ran, but the necessary variables I needed for my virtual environment were thrown away as soon as the script finished running.</p>
<h2 id="solution">Solution<a hidden class="anchor" aria-hidden="true" href="#solution">#</a></h2>
<p>I removed the <code>source</code> line from my <code>venv.sh</code> script and just left the script to create the needed files and directories. I would then need to run that <code>source</code> command to enter the virtual environment.</p>
<p>Then I thought: Why don&rsquo;t I just string the commands together into one alias on my shell? Perfect.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># aliases.sh</span>
</span></span><span style="display:flex;"><span>alias venv<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;$HOME/src/dotfiles/bin/utils/venv.sh &amp;&amp; \
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    source .venv/bin/activate&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ... other aliases below here</span>
</span></span></code></pre></div><p>Running the <code>venv</code> alias would execute the <code>venv.sh</code> <strong>then</strong> run the <code>source</code> command in the context of the shell I am currently in.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e"># venv.sh</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create venv if not exists</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -d <span style="color:#e6db74">&#34;.venv&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Found .venv. Activating...&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    read -p <span style="color:#e6db74">&#34;.venv does not exist. Would you like to \
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">         create a venv for this directory? (y/n) &#34;</span> response
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$response<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;y&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>      echo <span style="color:#e6db74">&#34;Creating .venv directory @ </span>$PWD<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>      python3 -m venv .venv
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><p>If <code>venv.sh</code> finds an existing <code>.venv</code> directory, it does nothing. If the script does not find the <code>.venv</code> directory it prompts the user asking if the script has permission to create it. I know I could probably do without the prompt and just have the script create it. I decided to leave it in for now.</p>
<p>I guess my issue was with Bash and not venv. Anyway, I think I have to be careful. I&rsquo;ve been getting sidetracked and spending a lot of time configuring my environment. Off to building something!</p>
<p>Be sure to follow me <a href="https://twitter.com/chrisparaiso">@chrisparaiso</a>.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://chrisparaiso.dev/posts/preserving-quotes-in-yaml/">
    <span class="title">« Prev</span>
    <br>
    <span>Preserving Quotes in Yaml</span>
  </a>
  <a class="next" href="https://chrisparaiso.dev/posts/revisiting-my-development-environment/">
    <span class="title">Next »</span>
    <br>
    <span>Revisiting My Development Environment</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://chrisparaiso.dev/">Chris Paraiso</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
